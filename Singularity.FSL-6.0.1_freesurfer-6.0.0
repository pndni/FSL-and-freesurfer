Bootstrap: yum
OSVersion: 7
MirrorURL: http://mirror.centos.org/centos-%{OSVERSION}/%{OSVERSION}/os/x86_64/
Include: yum

%post
    yum install -y wget file bc tar gzip libquadmath
    wget --no-verbose https://surfer.nmr.mgh.harvard.edu/pub/dist/freesurfer/6.0.0/freesurfer-Linux-centos6_x86_64-stable-pub-v6.0.0.tar.gz
    tar -C /opt/ -xzvf freesurfer-Linux-centos6_x86_64-stable-pub-v6.0.0.tar.gz
    wget https://fsl.fmrib.ox.ac.uk/fsldownloads/fslinstaller.py
    python fslinstaller.py -V 6.0.1 -d /opt/fsl -E
    echo "export FREESURFER_HOME=/opt/freesurfer" >> $SINGULARITY_ENVIRONMENT
    cat /opt/freesurfer/SetUpFreeSurfer.sh >> $SINGULARITY_ENVIRONMENT
    cat /etc/profile.d/fsl.sh >> $SINGULARITY_ENVIRONMENT
    /opt/fsl/etc/fslconf/fslpython_install.sh -f /opt/fsl